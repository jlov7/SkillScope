{
  "title": "SkillScope â€” Skills Observability",
  "schemaVersion": 38,
  "version": 2,
  "templating": {
    "list": [
      {
        "name": "skill",
        "type": "query",
        "datasource": "Prometheus",
        "definition": "label_values(skill_name)",
        "hide": 0,
        "refresh": 2,
        "multi": true,
        "includeAll": true
      }
    ]
  },
  "panels": [
    {
      "type": "stat",
      "title": "Calls by Skill",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (skill_name) (gen_ai_client_operation_duration_count)",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 6, "w": 8, "x": 0, "y": 0 }
    },
    {
      "type": "stat",
      "title": "Approval Required %",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "100 * sum by (skill_name) (skill_policy_required) / clamp_min(sum by (skill_name) (gen_ai_client_operation_duration_count), 1)",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 6, "w": 8, "x": 8, "y": 0 }
    },
    {
      "type": "timeseries",
      "title": "Token Usage (per minute)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "rate(gen_ai_client_token_usage[5m])",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 6 }
    },
    {
      "type": "timeseries",
      "title": "Latency p95 (seconds)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum by (le, skill_name) (rate(gen_ai_client_operation_duration_bucket[5m])))",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 6 }
    },
    {
      "type": "bargauge",
      "title": "Files Loaded (avg)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "avg by (skill_name) (skill_files_loaded_count)",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 6, "w": 12, "x": 0, "y": 14 }
    },
    {
      "type": "table",
      "title": "Recent Calls",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "topk(10, gen_ai_client_operation_duration_sum)",
          "legendFormat": "{{skill_name}}"
        }
      ],
      "gridPos": { "h": 6, "w": 12, "x": 12, "y": 14 }
    }
  ]
}
